
--
--  Test Case Runs Table Installation
--

create table wt_testcase_runs
   (test_run_id         number(38)   constraint wt_testcase_stats_nn1 not null
   ,testcase_id         number(38)   constraint wt_testcase_stats_nn2 not null
   ,yield_pct           number(3)    constraint wt_testcase_stats_nn3 not null
   ,asserts             number(7)    constraint wt_testcase_stats_nn4 not null
   ,passes              number(7)    constraint wt_testcase_stats_nn5 not null
   ,failures            number(7)    constraint wt_testcase_stats_nn6 not null
   ,min_interval_msecs  number(10)   constraint wt_testcase_stats_nn7 not null
   ,avg_interval_msecs  number(10)   constraint wt_testcase_stats_nn8 not null
   ,max_interval_msecs  number(10)   constraint wt_testcase_stats_nn9 not null
   ,tot_interval_msecs  number(10)   constraint wt_testcase_stats_nn10 not null
   ,constraint wt_testcase_stats_pk primary key (testcase_id)
   ,constraint wt_testcase_stats_nk1 unique (test_run_id, testcase)
   ,constraint wt_testcase_stats_fk1 foreign key (test_run_id)
       references wt_test_runs (id)
   ,constraint wt_testcase_stats_fk2 foreign key (testcase_id)
       references wt_testcases (id)
   ,constraint wt_testcase_stats_ck1 check (yield_pct between 0 and 100)
   ,constraint wt_testcase_stats_ck2 check (asserts   = passes + failures)
   ,constraint wt_testcase_stats_ck3 check (passes   >= 0)
   ,constraint wt_testcase_stats_ck4 check (failures >= 0)
   ,constraint wt_testcase_stats_ck5 check (min_interval_msecs >= 0)
   ,constraint wt_testcase_stats_ck6 check (avg_interval_msecs >= min_interval_msecs)
   ,constraint wt_testcase_stats_ck7 check (max_interval_msecs >= avg_interval_msecs)
   ,constraint wt_testcase_stats_ck8 check (tot_interval_msecs >= max_interval_msecs)
   ) pctfree 0;

comment on table wt_testcase_stats is 'Test Run data statistics for each testcase in the execution of a Test Runner.';
comment on column wt_testcase_stats.test_run_id is 'Primary Key for each Test Run. Also the Test Runs Foreign Key.';
comment on column wt_testcase_stats.testcase_id is 'Primary Key (part 2) for each Test Case. Also the Test Cases Foreign Key.';
comment on column wt_testcase_stats.yield_pct is 'Percentage of successful assertions to total assertions.';
comment on column wt_testcase_stats.asserts is 'Total number of assetions for the Test Case.';
comment on column wt_testcase_stats.passes is 'Number of passed assertions for the Test Case.';
comment on column wt_testcase_stats.failures is 'Number of failed assertions for the Test Case.';
comment on column wt_testcase_stats.min_interval_msecs is 'Minimum interval time between assertions in milliseconds for the Test Case';
comment on column wt_testcase_stats.avg_interval_msecs is 'Average interval time between assertions in milliseconds for the Test Case';
comment on column wt_testcase_stats.max_interval_msecs is 'Maximum interval time between assertions in milliseconds for the Test Case';
comment on column wt_testcase_stats.tot_interval_msecs is 'Total (sum) of interval times between assertions in milliseconds for the Test Case';

grant select on wt_testcase_stats to public;
grant delete on wt_testcase_stats to public;
